title(ylab ="RSG value", line = 2, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.5)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 4, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.5)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 7, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 7, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(9,5.1,4.1,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 7, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,9,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 7, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,9))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 7, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 7, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1, mgp = c(5.1,1,0))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "RSG value", las = 1, cex.lab = 1.2, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1, mgp = c(5.1,1,0))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "RSG value", sude=2, line = 5, las = 1, cex.lab = 1.2, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1, mgp = c(5.1,1,0))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "RSG value", side=2, line = 5, las = 1, cex.lab = 1.2, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1, mgp = c(5.1,1,0))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity",las = 1, cex.lab = 1.2, cex.axis = 1.25)
mtext("RSG value", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1, mgp = c(5.1,1,0))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
mtext("RSG value", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
mtext("RSG value", side = 2, line = 4)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1))
plot(ranks, log(rac), type = 'p', axes = F, xlab = "Rank in abundance", ylab = "log(abundance)", las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", ylab = "log(abundance)", las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", ylab = "abundance", las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", ylab = "abundance", las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("abundance", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", las = 1, cex.lab = 1.4, cex.axis = 1.25)
#mtext("abundance", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", las = 1, cex.lab = 1.4, cex.axis = 1.25)
#mtext("abundance", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("abundance", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("abundance", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("RSG-H value", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("RSG-H value", side = 2, line = 5, cex.lab = 1.4)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
fcs <- flowCore::read.FCS(file = "../data/B1_Live-RSG.fcs")
flow <- exprs(fcs)
RSG_H <- as.data.frame(flow[,"BL1-H"])
RAC <- function(x = ""){
x = as.vector(x)
x.ab = x[x >0]
x.ab.ranked = x.ab[order(x.ab, decreasing = TRUE)]
return(x.ab.ranked)
}
fcs <- flowCore::read.FCS(file = "../data/B1_Live-RSG.fcs")
flow <- exprs(fcs)
RSG_H <- as.matrix(flow[,"BL1-H"])
plot.new()
rac <- RAC(x = RSG_H)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("RSG-H value", side = 2, line = 5, cex.lab = 1.4)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
fcs <- flowCore::read.FCS(file = "../data/B1_Live-RSG.fcs")
flow <- exprs(fcs)
RSG_H <- as.matrix(flow[,"FSC-H"])
plot.new()
rac <- RAC(x = RSG_H)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("RSG-H value", side = 2, line = 5, cex.lab = 1.4)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
fcs <- flowCore::read.FCS(file = "../data/B1_Live-RSG.fcs")
flow <- exprs(fcs)
RSG_H <- as.matrix(flow[,"BL1-A"])
plot.new()
rac <- RAC(x = RSG_H)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("RSG-H value", side = 2, line = 5, cex.lab = 1.4)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
rm(list = ls())
getwd()
install.packages("BiocManager")
library("BiocManager")
BiocManager::install("flowCore", version = "3.8")
BiocManager::install("ggcyto")
library("BiocManager")
library("flowCore")
library("ggcyto")
fcs_C1 <- flowCore::read.FCS(file = "../data/C1_Live-RSG+SA.fcs")
test1 <-(95.61, 25.12, 24.15, 58.29, 62.68, 63.66, 100.00, 92.20,33.17, 35.12, 64.63, 73.41, 83.17, 99.51, 54.15,83.17,61.95, 96.34,90.24,72.20,73.41,71.71,76.83, 82.44,92.68,74.63, 55.61,99.02,90.98,88.78,98.05,99.02,79.7682.20)
test1 <-c(95.61, 25.12, 24.15, 58.29, 62.68, 63.66, 100.00, 92.20,33.17, 35.12, 64.63, 73.41, 83.17, 99.51, 54.15,83.17,61.95, 96.34,90.24,72.20,73.41,71.71,76.83, 82.44,92.68,74.63, 55.61,99.02,90.98,88.78,98.05,99.02,79.7682.20)
test1 <-c(95.61)
test1 <-c(95.61, 25.12, 24.15, 58.29, 62.68, 63.66, 100.00, 92.20,33.17, 35.12, 64.63, 73.41, 83.17, 99.51, 54.15,83.17,61.95, 96.34,90.24,72.20,73.41,71.71,76.83, 82.44,92.68,74.63, 55.61,99.02,90.98,88.78,98.05,99.02,79.76,82.20)
test1
histogram(test1)
hist(test1)
density(test1)
test1.d<-density(test1)
plot(test1.d)
test1
mean(test1)
median(test1)
sum(test1 > 90)
11/36
sum(test1 > 80)
16/36
sum(test1 < 65)
sum(test1 > 95)
7/36
rm(list=ls())
getwd()
setwd("~/GitHub/MinimalCell")
rm(list=ls())
getwd()
setwd("~/GitHub/MinimalCell")
require("png")
require("dplyr")
require("grid")
LL.95 <- function(x) t.test(x)$conf.int[1]
UL.95 <- function(x) t.test(x)$conf.int[2]
sem <- function(x) sqrt(var(x)/length(x))
cv <- function(x) sd(x)/sqrt(mean(x))
dnds <- read.csv("~/GitHub/MinimalCell/datafiles/cases_Mm.300.csv")
colnames(dnds)[12] <- "dnds"
colnames(dnds)[2] <- "strain"
# Convert strain to factor
dnds$strain <- as.factor(dnds$strain)
# Add x-values for plotting
x <- c(1,1,1,1,3,3,3,3)
dnds <- data.frame(dnds, x)
# Subset dN/dS by strain and summary statistics
dnds.wt  <- filter(dnds, strain == "Non-minimal") %>%
dplyr::select(strain, dnds, x)
dnds.min  <- filter(dnds, strain == "Minimal") %>%
dplyr::select(strain, dnds, x)
median.dnds.wt <-median(dnds.wt$dnds)
LL.95.dnds.wt <- LL.95(dnds.wt$dnds)
UL.95.dnds.wt <- UL.95(dnds.wt$dnds)
mean.dnds.wt<-mean(dnds.wt$dnds)
sem.dnds.wt<-sem(dnds.wt$dnds)
median.dnds.min <-median(dnds.min$dnds)
LL.95.dnds.min <- LL.95(dnds.min$dnds)
UL.95.dnds.min <- UL.95(dnds.min$dnds)
mean.dnds.min<-mean(dnds.min$dnds)
sem.dnds.min<-sem(dnds.min$dnds)
# Non-minimal data: essential vs. non-essential
dndds.nonmin <- read.csv("~/GitHub/MinimalCell/datafiles/non-minimal.DNDS_freqs.csv")
equal.var <- var.test(dnds.wt$dnds, dnds.min$dnds)
# Test for equal variance : P = 0.170 --> homogeneous variance
# Non-minimal vs. minimal
dnds.ttest <- t.test(dnds.wt$dnds, dnds.min$dnds, var.equal = TRUE, alternative = 'two.sided')
# Results: t = 0.81011, df = 6, p-value = 0.488 --> no difference
# Minimal: dN/dS different from 1?
dnds.min.ttest <- t.test(dnds.min$dnds, mu = 1, alternative ="two.sided")
mean(dnds.wt.noout$dnds)
dnds.wt.noout <- dnds.wt %>%
filter(dnds < "2")
mean(dnds.wt.noout$dnds)
png(filename="~/GitHub/MinimalCell/figures/FigExt2.png",
width = 1200, height = 1200, res = 96*2)
plot.new()
par(mar = c(7, 7, 5, 7))
# Add Non-minimal points
plot(jitter(rep(1, length(dnds.wt$dnds)), amount = 0.2), dnds.wt$dnds,
xlim = c(0, 4), ylim = c(0.0, 2.5), type = "p", pch = 21, bg = "lightblue",
col = "lightblue", cex = 1.0, ylab = "", xlab = "",
cex.lab = 2.0, las = 1, lwd = 2, yaxt = "n", xaxt = "n")
box(lwd=2)
# Add horizontal line
abline(h = 1, col="darkgray", lty = 2, lwd = 2)
# Add minimal points
points(jitter(rep(3, length(dnds.min$dnds)), amount = 0.2), dnds.min$dnds,
pch = 21, bg = "pink", col = "pink", lwd = 2, cex = 1.0)
# Add confidence intervals
arrows(x0 = c(1), y0 = mean.dnds.wt, y1 = mean.dnds.wt + sem.dnds.wt, angle = 90,
length = 0.1, lwd = 2, col = "blue")
arrows(x0 = c(1), y0 = mean.dnds.wt, y1 = mean.dnds.wt - sem.dnds.wt, angle = 90,
length=0.1, lwd = 2, col = "blue")
arrows(x0 = c(3), y0 = mean.dnds.min, y1 = mean.dnds.min + sem.dnds.min, angle = 90,
length = 0.1, lwd = 2, col = "red")
arrows(x0 = c(3), y0 = mean.dnds.min, y1 = mean.dnds.min - sem.dnds.min, angle = 90,
length=0.1, lwd = 2, col = "red")
# Add means
points(1, mean.dnds.wt, pch = 22, col = "blue",
bg = "blue", lwd = 2, cex = 2)
points(3, mean.dnds.min, pch = 22, col = "red",
bg = "red", lwd = 2, cex = 2)
# Add axes and labels
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = c("0.0", "1.0", "2.0", "3.0"), at = c(0,1, 2, 3))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at=c(0, 1, 2, 3), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at = c(1, 3), labels = F)
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = c("Non-minimal", "Minimal"),
col.axis = "darkgray", at = c(1, 3))
mtext(expression('Strain'), side = 1,
outer = TRUE, cex = 1.5, line = -3.5, adj = 0.5)
mtext(expression(italic("dN/dS")), side = 2,
outer = TRUE, cex = 1.5, line = -3.0)
# Add P-values
#mtext(expression(~italic("P")~"= 0.488"), line = -2.0, cex = 1.0, at = 0.5)
# Close Plot Device
dev.off()
graphics.off()
# Show Plot
img <- readPNG("~/GitHub/MinimalCell/figures/FigExt2.png")
grid.raster(img)
png(filename="~/GitHub/MinimalCell/figures/FigExt2.png",
width = 1200, height = 1200, res = 96*2)
plot.new()
par(mar = c(7, 7, 5, 7))
# Add Non-minimal points
plot(jitter(rep(1, length(dnds.wt$dnds)), amount = 0.2), dnds.wt$dnds,
xlim = c(0, 4), ylim = c(0.0, 2.5), type = "p", pch = 21, bg = "lightblue",
col = "lightblue", cex = 1.0, ylab = "", xlab = "",
cex.lab = 2.0, las = 1, lwd = 2, yaxt = "n", xaxt = "n")
box(lwd=2)
# Add horizontal line
abline(h = 1, col="darkgray", lty = 2, lwd = 2)
# Add minimal points
points(jitter(rep(3, length(dnds.min$dnds)), amount = 0.2), dnds.min$dnds,
pch = 21, bg = "pink", col = "pink", lwd = 2, cex = 1.0)
# Add confidence intervals
arrows(x0 = c(1), y0 = mean.dnds.wt, y1 = mean.dnds.wt + sem.dnds.wt, angle = 90,
length = 0.1, lwd = 2, col = "blue")
arrows(x0 = c(1), y0 = mean.dnds.wt, y1 = mean.dnds.wt - sem.dnds.wt, angle = 90,
length=0.1, lwd = 2, col = "blue")
arrows(x0 = c(3), y0 = mean.dnds.min, y1 = mean.dnds.min + sem.dnds.min, angle = 90,
length = 0.1, lwd = 2, col = "red")
arrows(x0 = c(3), y0 = mean.dnds.min, y1 = mean.dnds.min - sem.dnds.min, angle = 90,
length=0.1, lwd = 2, col = "red")
# Add means
points(1, mean.dnds.wt, pch = 22, col = "blue",
bg = "blue", lwd = 2, cex = 2)
points(3, mean.dnds.min, pch = 22, col = "red",
bg = "red", lwd = 2, cex = 2)
# Add axes and labels
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = c("0.0", "1.0", "2.0", "3.0"), at = c(0,1, 2, 3))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at=c(0, 1, 2, 3), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25, las = 1,
at = c(1, 3), labels = F)
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = c("Non-minimal", "Minimal"),
col.axis = "darkgray", at = c(1, 3))
mtext(expression('Strain'), side = 1,
outer = TRUE, cex = 1.5, line = -3.5, adj = 0.5)
mtext(expression(italic("dN/dS")), side = 2,
outer = TRUE, cex = 1.5, line = -3.0)
# Add P-values
#mtext(expression(~italic("P")~"= 0.488"), line = -2.0, cex = 1.0, at = 0.5)
# Close Plot Device
dev.off()
graphics.off()
# Show Plot
img <- readPNG("~/GitHub/MinimalCell/figures/FigExt2.png")
grid.raster(img)
