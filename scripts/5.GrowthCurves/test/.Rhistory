ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,9,4.1,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "RSG value", las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "RSG value", las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.5)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "RSG value", las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.5)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "RSG value", las = 1, cex.lab = 1.8, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.5)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "RSG value", las = 1, cex.lab = 5, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.5)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "RSG value", las = 1, cex.lab = 1.2, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.5)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = -2, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.5)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 2, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.5)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 4, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.5)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 7, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 7, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(9,5.1,4.1,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 7, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,9,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 7, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,9))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 7, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
title(ylab ="RSG value", line = 7, cex.lab = 1.2)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1, mgp = c(5.1,1,0))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "RSG value", las = 1, cex.lab = 1.2, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1, mgp = c(5.1,1,0))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "RSG value", sude=2, line = 5, las = 1, cex.lab = 1.2, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1, mgp = c(5.1,1,0))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "RSG value", side=2, line = 5, las = 1, cex.lab = 1.2, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1, mgp = c(5.1,1,0))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity",las = 1, cex.lab = 1.2, cex.axis = 1.25)
mtext("RSG value", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1, mgp = c(5.1,1,0))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
mtext("RSG value", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", las = 1, cex.lab = 1.2, cex.axis = 1.25)
mtext("RSG value", side = 2, line = 4)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1))
plot(ranks, log(rac), type = 'p', axes = F, xlab = "Rank in abundance", ylab = "log(abundance)", las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", ylab = "log(abundance)", las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1,5.1,4.1,2.1))
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", ylab = "abundance", las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", ylab = "abundance", las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("abundance", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", las = 1, cex.lab = 1.4, cex.axis = 1.25)
#mtext("abundance", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", las = 1, cex.lab = 1.4, cex.axis = 1.25)
#mtext("abundance", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("abundance", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in abundance", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("abundance", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("RSG-H value", side = 2, line = 5)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
plot.new()
rac <- RAC(x = RSG_H$`flow[, "BL1-H"]`)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("RSG-H value", side = 2, line = 5, cex.lab = 1.4)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
fcs <- flowCore::read.FCS(file = "../data/B1_Live-RSG.fcs")
flow <- exprs(fcs)
RSG_H <- as.data.frame(flow[,"BL1-H"])
RAC <- function(x = ""){
x = as.vector(x)
x.ab = x[x >0]
x.ab.ranked = x.ab[order(x.ab, decreasing = TRUE)]
return(x.ab.ranked)
}
fcs <- flowCore::read.FCS(file = "../data/B1_Live-RSG.fcs")
flow <- exprs(fcs)
RSG_H <- as.matrix(flow[,"BL1-H"])
plot.new()
rac <- RAC(x = RSG_H)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("RSG-H value", side = 2, line = 5, cex.lab = 1.4)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
fcs <- flowCore::read.FCS(file = "../data/B1_Live-RSG.fcs")
flow <- exprs(fcs)
RSG_H <- as.matrix(flow[,"FSC-H"])
plot.new()
rac <- RAC(x = RSG_H)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("RSG-H value", side = 2, line = 5, cex.lab = 1.4)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
fcs <- flowCore::read.FCS(file = "../data/B1_Live-RSG.fcs")
flow <- exprs(fcs)
RSG_H <- as.matrix(flow[,"BL1-A"])
plot.new()
rac <- RAC(x = RSG_H)
ranks <- as.vector(seq(1,length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5,6,4,2)+0.1)
plot(ranks, rac, type = 'p', axes = F, xlab = "Rank in activity", ylab = "", las = 1, cex.lab = 1.4, cex.axis = 1.25)
mtext("RSG-H value", side = 2, line = 5, cex.lab = 1.4)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.25)
par <- opar
rm(list = ls())
getwd()
install.packages("BiocManager")
library("BiocManager")
BiocManager::install("flowCore", version = "3.8")
BiocManager::install("ggcyto")
library("BiocManager")
library("flowCore")
library("ggcyto")
fcs_C1 <- flowCore::read.FCS(file = "../data/C1_Live-RSG+SA.fcs")
test1 <-(95.61, 25.12, 24.15, 58.29, 62.68, 63.66, 100.00, 92.20,33.17, 35.12, 64.63, 73.41, 83.17, 99.51, 54.15,83.17,61.95, 96.34,90.24,72.20,73.41,71.71,76.83, 82.44,92.68,74.63, 55.61,99.02,90.98,88.78,98.05,99.02,79.7682.20)
test1 <-c(95.61, 25.12, 24.15, 58.29, 62.68, 63.66, 100.00, 92.20,33.17, 35.12, 64.63, 73.41, 83.17, 99.51, 54.15,83.17,61.95, 96.34,90.24,72.20,73.41,71.71,76.83, 82.44,92.68,74.63, 55.61,99.02,90.98,88.78,98.05,99.02,79.7682.20)
test1 <-c(95.61)
test1 <-c(95.61, 25.12, 24.15, 58.29, 62.68, 63.66, 100.00, 92.20,33.17, 35.12, 64.63, 73.41, 83.17, 99.51, 54.15,83.17,61.95, 96.34,90.24,72.20,73.41,71.71,76.83, 82.44,92.68,74.63, 55.61,99.02,90.98,88.78,98.05,99.02,79.76,82.20)
test1
histogram(test1)
hist(test1)
density(test1)
test1.d<-density(test1)
plot(test1.d)
test1
mean(test1)
median(test1)
sum(test1 > 90)
11/36
sum(test1 > 80)
16/36
sum(test1 < 65)
sum(test1 > 95)
7/36
rm(list=ls())
getwd()
setwd("~/Github/MinimalCell/scripts/5.GrowthCurves/test")
require("png")
require("dplyr")
require("grid")
require("gtools")
require("MPN")
require("nlme")
require("MuMIn")
source("../bin/modified_Gomp.R")
library(tidyverse)
LL.95 <- function(x) t.test(x)$conf.int[1]
UL.95 <- function(x) t.test(x)$conf.int[2]
sem <- function(x) sqrt(var(x)/length(x))
cv <- function(x) sd(x)/sqrt(mean(x))
data <- read.csv("../data/mpn.csv")
# MPN parameters
# tubes <- rep(6, 12)# ni = number of "tubes" or aliquots of same dilution
# d <- 10^(-1:-11)
# d <- 10^(0:-11) # volume in microliters
# v <- 20 * d #zi transfer volume of original culture
q = 20 # transfer volume in dilution = 20 uL
i = 10 # initial dilution = 20 uL of culture added to 180 uL medium
data <- data  %>%
mutate(vol = dilutions * q * i, .before = pos) %>%
mutate(tubes = rep(6, nrow(data)), .before = pos)
# Minimal
m.group <- filter(data, cell == "min") %>%
group_by(time, biorep) %>%
dplyr::summarise(MPN = mpn(pos, tubes, vol))
# Pull out each MPN estimate from function
m.mpn.out <- m.group[seq(1, nrow(m.group), 9), ]
# Convert,transpose, and plot MPN values
m.mpn.out <- t(do.call(rbind.data.frame, m.mpn.out))
plot(m.mpn.out[,1],log10(m.mpn.out[,3]))
# Non-minimal
nm.group <- filter(data, cell == "nm") %>%
group_by(time, biorep) %>%
dplyr::summarise(MPN = mpn(pos, tubes, vol))
# Pull out each mpn estimate from function
nm.mpn.out <- nm.group[seq(1, nrow(nm.group), 9), ]
# Convert, transpose, and plot MPN values
nm.mpn.out <- t(do.call(rbind.data.frame, nm.mpn.out))
plot(nm.mpn.out[,1],log10(nm.mpn.out[,3]))
nm.plate <- read.csv("../data/mpn.platereader.NM.csv")
m.plate <- read.csv("../data/mpn.platereader.M.csv")
# Change times to numeric
nm.plate$Time <- as.numeric(sub("^(\\d+):(\\d+).*", "\\1.\\2", nm.plate$Time))
head(nm.plate, header = T)
m.plate$Time <- as.numeric(sub("^(\\d+):(\\d+).*", "\\1.\\2", m.plate$Time))
head(m.plate, header = T)
# Pull out wells over time
nm.wells <-  nm.plate[,c(1:48)]
m.wells <-  m.plate[,c(1,11:16,19:24,27:32,36:40,43:48,52:56)]
# Run Gompertz (only need to run once then comment out)
#nm.curves <- growth.modGomp(input = nm.wells, output.name = "nm.platereader.parms",
#               synergy = F, temp = F, smooth = T, trim = T)
#m.curves <- growth.modGomp(input = m.wells, output.name = "m.platereader.parms",
#               synergy = F, temp = F, smooth = T, trim = T)
nm.curves.out <- read.table("../output/nm.platereader.parms.txt",
sep = ",", header=TRUE)
m.curves.out <- read.table("../output/m.platereader.parms.txt",
sep = ",", header=TRUE)
nm.umax.range <- nm.curves.out %>%
filter(umax == min(umax) | umax == max(umax))
nm.mean.parms <- nm.curves.out %>%
plyr::summarise(b0 = mean(b0), A = mean(A), umax = mean(umax), lag = mean(L))
nm.cv.parms <- nm.curves.out %>%
plyr::summarise(cv.A = cv(A), cv.umax = cv(umax), cv.lag = cv(L))
nm.cv.parms
m.cv.parms <- m.curves.out %>%
plyr::summarise(cv.A = cv(A), cv.umax = cv(umax), cv.lag = cv(L))
m.cv.parms
dim(nm.curves.out)
dim(m.curves.out)
